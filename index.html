<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="stylesheet" href="upload.css">
    <title>Extract Text</title>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
</head>
<body>
    <div class="container">
        <div class="card">
            <div class="flexColumn">
                <h1>Extract text</h1>
                <p>You can extract complex text (such as mathematical equations, etc.) by uploading images, copy it, and input it into the main input field to get an instant solution.</p>
                <img src="capture.jpg" id="profile-pic" height="200px" width="auto">
            </div>
            <div class="flexrow">
                
                <!-- Use the 'capture' attribute to request camera permission -->
                <label for="input-file" id="uploadImg">Upload image</label>
                <input type="file" accept="image/*" id="input-file" capture="camera">
                <button id="extract-button">Extract Text</button>
               
            </div>
            <button id="restart-button">Restart</button> <!-- Added restart button -->
            <div id="loading-indicator" style="display: none;">Extracting text...</div>
            <div class="textarea-container">
                <textarea id="text-output" rows="10" cols="40" placeholder="Extracted text here"></textarea>
                <button id="copy-button">Copy</button>
            </div>
        </div>
    </div>
    <script src="https://cdn.rawgit.com/naptha/tesseract.js/1.0.10/dist/tesseract.js"></script>
    <script>
        window.onload = function () {
            let profilePic = document.getElementById("profile-pic");
            let inputFile = document.getElementById("input-file");
            let extractButton = document.getElementById("extract-button");
            let textOutput = document.getElementById("text-output");
            let loadingIndicator = document.getElementById("loading-indicator");
            let copyButton = document.getElementById("copy-button");
            let restartButton = document.getElementById("restart-button"); // Added restart button


             
            // Function to reset the text output
            function resetTextOutput() {
                textOutput.value = "";
                MathJax.typesetPromise().then(() => {
                    MathJax.typesetClear([textOutput]);
                    MathJax.typesetPromise([textOutput]);
                });
            }

            inputFile.onchange = function () {
                profilePic.src = URL.createObjectURL(inputFile.files[0]);
            };

            extractButton.onclick = function () {
                resetTextOutput(); // Reset text output before extraction
                loadingIndicator.style.display = "block";

                Tesseract.recognize(
                    profilePic.src,
                    "eng",
                    {
                        logger: (m) => console.log(m),
                        lineSeparator: "\n",
                        preserve_interword_spaces: 1,
                    }
                )
                .then((result) => {
                    console.log(result.text);

                    // Extracted text containing mathematical equations
                    let extractedText = result.text;

                    // Display the extracted text in the textarea
                    textOutput.value = extractedText;

                    // Render mathematical equations using MathJax
                    MathJax.typesetPromise().then(() => {
                        MathJax.typesetClear([textOutput]);
                        MathJax.typesetPromise([textOutput]);
                    });
                })
                .catch((error) => {
                    console.error("An error occurred during text extraction:", error);
                })
                .finally(() => {
                    loadingIndicator.style.display = "none";
                });
            };

            copyButton.onclick = function () {
                textOutput.select();
                document.execCommand("copy");

                // Change the button text to "Copied"
                copyButton.innerText = "Copied";

                // Hide the "Copied" message and revert the button text after 2 seconds
                setTimeout(function () {
                    copyButton.innerText = "Copy";
                }, 2000);
            };

            restartButton.onclick = function () {
                resetTextOutput(); // Reset text output on restart
                inputFile.value = ""; // Clear the file input
                profilePic.src = "capture.jpg"; // Clear the image
            };
        };


        
    </script>
</body>
</html>
